"use strict";angular.module("varroa.upload",["ngFileUpload"]),angular.module("varroa.upload").controller("UploadsCtrl",["$http",function(a){var l=this;l.uploads=[],a.get("/api/uploads").success(function(a){l.uploads=a,l.uploads.length&&l.select(0)});var e=function(){l.index>l.uploads.length-1&&(l.index=0),l.index<0&&(l.index=l.uploads.length-1),l.selected=l.uploads[l.index]};l.next=function(){l.index++,e()},l.prev=function(){l.index--,e()},l.select=function(a){l.index=a,e()}}]),angular.module("varroa.upload").controller("UploadCtrl",["_","$upload","$timeout","$q",function(a,l,e,t){var o=this;o.files=[],o.uploads=[];var r=function(a,e){var r=t.defer();return o.uploads[e]={i:e,progress:0},l.upload({url:"/api/uploads",file:a,fields:{name:o.name}}).progress(function(a){var l=a.loaded,t=a.total;o.uploads[e]&&(o.uploads[e].progress=parseInt(100*l/t))}).success(function(){return r.resolve()}).error(function(a){r.reject(a)}),r.promise};o.submit=function(){o.error=o.success=void 0,o.inProgress=!0;var l=a.map(o.files,r);t.all(l).then(function(){o.success=!0,o.inProgress=!1,o.files=[],e(function(){return o.uploads=[]},3e3)})["catch"](function(a){o.error=a,o.uploads=[],o.inProgress=!1})}}]),angular.module("varroa",["ui.router","angularMoment","varroa.upload"]).constant("_",window._).config(["$stateProvider","$urlRouterProvider",function(a,l){a.state("varroa",{views:{"@":{templateUrl:"/varroa/layout/layout.html"},"header@":{templateUrl:"/varroa/layout/header.html"}}}).state("home",{parent:"varroa",templateUrl:"/varroa/home/home.html",url:"/"}).state("uploads",{parent:"varroa",controller:"UploadsCtrl as uploadsCtrl",templateUrl:"/varroa/upload/uploads.html",url:"/uploads"}).state("upload",{parent:"varroa",controller:"UploadCtrl as uploadCtrl",templateUrl:"/varroa/upload/upload.html",url:"/add"}),l.otherwise("/")}]),function(a){try{a=angular.module("varroa")}catch(l){a=angular.module("varroa",[])}a.run(["$templateCache",function(a){a.put("/varroa/home/home.html",'<div class="jumbotron"><h1>Varroa Vision Project</h1><dl><dt>Varroa</dt><dd>a microscopic mite which is a debilitating parasite of the honeybee, causing loss of honey production.</dd></dl><h3>What We Hope</h3><p>That we can develop computer vision to detect the presence of varroa mite.</p><h3>What We Need</h3><p>Pictures of bees! Lots of pictures of bees. A thousand pictures of frames of bees would be great; ten thousand would be better &mdash; we need all kinds and in all sorts of lighting.</p><button class="btn btn-lg btn-block btn-primary" ui-sref="upload">I want to help</button></div>')}])}(),function(a){try{a=angular.module("varroa")}catch(l){a=angular.module("varroa",[])}a.run(["$templateCache",function(a){a.put("/varroa/layout/header.html",'<div class="container-fluid"><div class="navbar-header"><button class="navbar-toggle collapsed" type="button" data-toggle="collapse"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a ui-sref="home" class="navbar-brand">Varroa Vision</a></div><nav class="collapse navbar-collapse"><ul class="nav navbar-nav"><li><a ui-sref="upload">Add Pictures</a></li><li><a ui-sref="uploads">Uploads</a></li></ul></nav></div>')}])}(),function(a){try{a=angular.module("varroa")}catch(l){a=angular.module("varroa",[])}a.run(["$templateCache",function(a){a.put("/varroa/layout/layout.html",'<header class="navbar navbar-fixed-top" role="banner" ui-view="header@"></header><section class="container-fluid"><ui-view></ui-view></section>')}])}(),function(a){try{a=angular.module("varroa")}catch(l){a=angular.module("varroa",[])}a.run(["$templateCache",function(a){a.put("/varroa/upload/upload.html",'<section class="container-fluid"><div class="row"><div class="col-xs-12"><h3>Upload Files</h3><p>Upload pictures of bee frames here.</p><p>If they have mites that\'s great, but we need pictures of "normal" bees too! Ideally they\'ll be pictures from a phone.</p><form name="form"><div class="form-group"><input class="form-control input-lg" ng-model="uploadCtrl.name" placeholder="Your name â€” optional!"></div><div class="form-group"><div ng-file-select ng-file-drop ng-model="uploadCtrl.files" drag-over-class="{accept:\'ok\', reject:\'err\', delay:100}" class="droppable" ng-multiple="true" allow-dir="false" ng-accept="\'image/*\'" drop-available="dropAvailable" style="overflow: hidden"><div ng-hide="dropAvailable" class="ide">File Drop not available</div><div ng-show="dropAvailable && !uploadCtrl.files.length" class="">drop images here</div><div ng-repeat="file in uploadCtrl.files"><i class="fa fa-picture-o text-success"></i> {{file.name}}</div></div></div><div class="form-group"><button class="btn btn-lg btn-primary btn-block" ng-disabled="!uploadCtrl.files.length" ng-click="uploadCtrl.submit()" ng-hide="uploadCtrl.inProgress"><i class="fa fa-upload"></i> Upload</button></div><div class="form-group"><div class="progress" ng-show="uploadCtrl.uploads.length" ng-repeat="upload in uploadCtrl.uploads"><div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="{{upload.progress}}" aria-valuemin="0" aria-valuemax="100" style="width: {{upload.progress}}%"><span class="sr-only">{{upload.progress}}% complete</span></div></div><div class="alert alert-success" ng-show="uploadCtrl.success"><i class="fa fa-check"></i> Upload complete! Thanks!</div><div class="alert alert-danger" ng-show="uploadCtrl.error"><i class="fa fa-close"></i> Upload failed. Please try again later. <code>{{uploadCtrl.error}}</code></div></div></form></div></div></section>')}])}(),function(a){try{a=angular.module("varroa")}catch(l){a=angular.module("varroa",[])}a.run(["$templateCache",function(a){a.put("/varroa/upload/uploads.html",'<section class="container-fluid"><div class="jumbotron" ng-if="uploadsCtrl.selected"><div class="col-md-8"><img class="uploads-img" src="{{uploadsCtrl.selected.url}}"></div><div class="col-md-4"><table class="table table-striped table-condensed"><tbody><tr><td>{{uploadsCtrl.index + 1}} of {{uploadsCtrl.uploads.length}} images</td></tr><tr><td>{{uploadsCtrl.selected.name}}</td></tr><tr><td>{{uploadsCtrl.selected.size}}</td></tr><tr><td><span am-time-ago="uploadsCtrl.selected.ts"></span></td></tr><tr><td><div class="btn-group"><button class="btn btn-default" ng-click="uploadsCtrl.prev()"><i class="fa fa-angle-double-left"></i></button> <button class="btn btn-default" ng-click="uploadsCtrl.next()"><i class="fa fa-angle-double-right"></i></button></div></td></tr></tbody></table></div></div><div class="row"><table class="table table-striped table-hover"><thead><tr><th>Image</th><th>Size</th><th>By</th><th>Uploaded</th></tr></thead><tbody><tr ng-repeat="upload in uploadsCtrl.uploads" ng-click="uploadsCtrl.select($index)" ng-class="{ info: $index == uploadsCtrl.index }"><td>{{upload.id}}</td><td>{{upload.size}}</td><td>{{upload.name}}</td><td><span am-time-ago="upload.ts"></span></td></tr></tbody></table></div></section>')}])}();